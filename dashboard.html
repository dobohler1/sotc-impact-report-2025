<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>STEM Program Dashboard</title>
    <!-- Load React and ReactDOM first -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <!-- Load Recharts -->
    <script src="https://unpkg.com/recharts@2.8.0/umd/Recharts.js"></script>
    <!-- Load PapaParse -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            margin: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            background-color: #f8fafc;
        }
        .dashboard-container {
            width: 100%;
            min-height: 100vh;
            padding: 20px;
        }
        .stat-card {
            transition: transform 0.2s ease;
        }
        .stat-card:hover {
            transform: translateY(-2px);
        }
        /* Custom color classes */
        .text-blue-600 { color: #2563eb; }
        .text-green-600 { color: #16a34a; }
        .text-purple-600 { color: #9333ea; }
        .text-orange-600 { color: #ea580c; }
        .border-blue-500 { border-color: #3b82f6; }
        .border-green-500 { border-color: #10b981; }
        .border-purple-500 { border-color: #8b5cf6; }
        .border-orange-500 { border-color: #f97316; }
        .text-blue-500 { color: #3b82f6; }
        .text-green-500 { color: #10b981; }
        .text-purple-500 { color: #8b5cf6; }
        .text-orange-500 { color: #f97316; }
    </style>
</head>
<body>
    <div id="dashboard-root" class="dashboard-container"></div>
    
    <script>
        // Wait for all scripts to load
        window.addEventListener('load', function() {
            // Verify React is loaded
            if (typeof React === 'undefined') {
                document.getElementById('dashboard-root').innerHTML = '<div style="text-align: center; padding: 50px; color: red;">Error: React not loaded. Please check your internet connection.</div>';
                return;
            }

            const { useState, useMemo, useEffect } = React;
            const { BarChart, Bar, LineChart, Line, XAxis, YAxis, CartesianGrid, Tooltip, Legend, ResponsiveContainer } = Recharts;

            // Icon components (simplified SVG versions)
            const Icons = {
                Search: () => React.createElement('svg', {
                    className: 'h-5 w-5',
                    fill: 'none',
                    viewBox: '0 0 24 24',
                    stroke: 'currentColor'
                }, React.createElement('path', {
                    strokeLinecap: 'round',
                    strokeLinejoin: 'round',
                    strokeWidth: 2,
                    d: 'M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z'
                })),
                Users: () => React.createElement('svg', {
                    className: 'h-8 w-8',
                    fill: 'none',
                    viewBox: '0 0 24 24',
                    stroke: 'currentColor'
                }, React.createElement('path', {
                    strokeLinecap: 'round',
                    strokeLinejoin: 'round',
                    strokeWidth: 2,
                    d: 'M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z'
                })),
                BookOpen: () => React.createElement('svg', {
                    className: 'h-8 w-8',
                    fill: 'none',
                    viewBox: '0 0 24 24',
                    stroke: 'currentColor'
                }, React.createElement('path', {
                    strokeLinecap: 'round',
                    strokeLinejoin: 'round',
                    strokeWidth: 2,
                    d: 'M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.746 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253'
                })),
                Monitor: () => React.createElement('svg', {
                    className: 'h-8 w-8',
                    fill: 'none',
                    viewBox: '0 0 24 24',
                    stroke: 'currentColor'
                }, React.createElement('path', {
                    strokeLinecap: 'round',
                    strokeLinejoin: 'round',
                    strokeWidth: 2,
                    d: 'M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z'
                })),
                TrendingUp: () => React.createElement('svg', {
                    className: 'h-8 w-8',
                    fill: 'none',
                    viewBox: '0 0 24 24',
                    stroke: 'currentColor'
                }, React.createElement('path', {
                    strokeLinecap: 'round',
                    strokeLinejoin: 'round',
                    strokeWidth: 2,
                    d: 'M13 7h8m0 0v8m0-8l-8 8-4-4-6 6'
                })),
                BarChart3: () => React.createElement('svg', {
                    className: 'h-16 w-16',
                    fill: 'none',
                    viewBox: '0 0 24 24',
                    stroke: 'currentColor'
                }, React.createElement('path', {
                    strokeLinecap: 'round',
                    strokeLinejoin: 'round',
                    strokeWidth: 2,
                    d: 'M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z'
                }))
            };

            const STEMDashboard = () => {
                const [activeView, setActiveView] = useState('overview');
                const [selectedCohort, setSelectedCohort] = useState('all');
                const [searchTerm, setSearchTerm] = useState('');
                const [data, setData] = useState([]);
                const [loading, setLoading] = useState(true);
                const [error, setError] = useState(null);

                // Load data on component mount
                useEffect(() => {
                    const loadData = async () => {
                        try {
                            // Try multiple possible paths for the CSV file
                            const possiblePaths = [
                                './data/SOTC SLUSD Data  Academic Performance.csv',
                                'data/SOTC SLUSD Data  Academic Performance.csv',
                                'SOTC SLUSD Data  Academic Performance.csv'
                            ];

                            let fileContent = null;
                            let loadedPath = null;

                            for (const path of possiblePaths) {
                                try {
                                    const response = await fetch(path);
                                    if (response.ok) {
                                        fileContent = await response.text();
                                        loadedPath = path;
                                        break;
                                    }
                                } catch (e) {
                                    console.log(`Failed to load from ${path}:`, e);
                                }
                            }

                            if (!fileContent) {
                                throw new Error('Could not load data file from any expected location');
                            }

                            console.log(`Data loaded successfully from: ${loadedPath}`);
                            
                            const parsedData = Papa.parse(fileContent, {
                                header: true,
                                dynamicTyping: true,
                                skipEmptyLines: true,
                                transformHeader: (header) => header.trim()
                            });

                            if (parsedData.errors.length > 0) {
                                console.warn('CSV parsing warnings:', parsedData.errors);
                            }

                            // Process and clean the data
                            const cleanData = parsedData.data.map(row => {
                                const cleanedRow = {};
                                for (let key in row) {
                                    let value = row[key];
                                    if (value === '#N/A' || value === 'NA' || value === null || value === '') {
                                        value = null;
                                    }
                                    // Handle percentage strings
                                    if (typeof value === 'string' && value.includes('%')) {
                                        const numValue = parseFloat(value.replace('%', ''));
                                        value = isNaN(numValue) ? null : numValue;
                                    }
                                    cleanedRow[key] = value;
                                }
                                return cleanedRow;
                            }).filter(row => row.ID); // Filter out empty rows

                            console.log(`Processed ${cleanData.length} student records`);
                            setData(cleanData);
                        } catch (error) {
                            console.error("Error loading data:", error);
                            setError(error.message);
                            
                            // Use realistic sample data for demonstration
                            const sampleData = [
                                { ID: "JM25a01", Cohort: "John Muir Spring 25", Duplicates: "Unique", "Math Pre-Test Score (10 max)": 7, "Math Post-Test Score (10 max)": 8, "Math Normalized Gain (%)": 50, "Computer Pre-Test Score (10 max)": 5, "Computer Post-Test Score (10 max)": 7, "Computer  Normalized Gain (%)": 67 },
                                { ID: "JM25a02", Cohort: "John Muir Spring 25", Duplicates: "Unique", "Math Pre-Test Score (10 max)": 6, "Math Post-Test Score (10 max)": 9, "Math Normalized Gain (%)": 75, "Computer Pre-Test Score (10 max)": 4, "Computer Post-Test Score (10 max)": 8, "Computer  Normalized Gain (%)": 100 },
                                { ID: "BA2501", Cohort: "Bancroft Spring 25", Duplicates: "Unique", "Math Pre-Test Score (10 max)": 5, "Math Post-Test Score (10 max)": 7, "Math Normalized Gain (%)": 40, "Computer Pre-Test Score (10 max)": 6, "Computer Post-Test Score (10 max)": 8, "Computer  Normalized Gain (%)": 50 },
                                { ID: "BA2502", Cohort: "Bancroft Spring 25", Duplicates: "Unique", "Math Pre-Test Score (10 max)": 8, "Math Post-Test Score (10 max)": 9, "Math Normalized Gain (%)": 50, "Computer Pre-Test Score (10 max)": 7, "Computer Post-Test Score (10 max)": 9, "Computer  Normalized Gain (%)": 67 },
                                { ID: "JM24b01", Cohort: "John Muir Fall 24", Duplicates: "Unique", "Math Pre-Test Score (10 max)": 6, "Math Post-Test Score (10 max)": 8, "Math Normalized Gain (%)": 50, "Computer Pre-Test Score (10 max)": 5, "Computer Post-Test Score (10 max)": 7, "Computer  Normalized Gain (%)": 40 },
                                { ID: "BA24b01", Cohort: "Bancroft Fall 24", Duplicates: "Unique", "Math Pre-Test Score (10 max)": 7, "Math Post-Test Score (10 max)": 9, "Math Normalized Gain (%)": 67, "Computer Pre-Test Score (10 max)": 6, "Computer Post-Test Score (10 max)": 8, "Computer  Normalized Gain (%)": 50 }
                            ];
                            setData(sampleData);
                        } finally {
                            setLoading(false);
                        }
                    };

                    loadData();
                }, []);

                // Get unique cohorts from data
                const cohorts = useMemo(() => {
                    const uniqueCohorts = [...new Set(data.map(d => d.Cohort).filter(Boolean))];
                    return uniqueCohorts.sort();
                }, [data]);

                // Calculate program-level statistics
                const programStats = useMemo(() => {
                    if (data.length === 0) return {};

                    const validMathScores = data.filter(d => 
                        d['Math Pre-Test Score (10 max)'] !== null && 
                        d['Math Post-Test Score (10 max)'] !== null
                    );
                    
                    const validCSScores = data.filter(d => 
                        d['Computer Pre-Test Score (10 max)'] !== null && 
                        d['Computer Post-Test Score (10 max)'] !== null
                    );

                    const mathPreAvg = validMathScores.length > 0 ? 
                        validMathScores.reduce((sum, d) => sum + d['Math Pre-Test Score (10 max)'], 0) / validMathScores.length : 0;
                    const mathPostAvg = validMathScores.length > 0 ? 
                        validMathScores.reduce((sum, d) => sum + d['Math Post-Test Score (10 max)'], 0) / validMathScores.length : 0;
                    const csPreAvg = validCSScores.length > 0 ? 
                        validCSScores.reduce((sum, d) => sum + d['Computer Pre-Test Score (10 max)'], 0) / validCSScores.length : 0;
                    const csPostAvg = validCSScores.length > 0 ? 
                        validCSScores.reduce((sum, d) => sum + d['Computer Post-Test Score (10 max)'], 0) / validCSScores.length : 0;

                    return {
                        totalStudents: data.length,
                        mathImprovement: mathPreAvg > 0 ? ((mathPostAvg - mathPreAvg) / mathPreAvg * 100).toFixed(1) : '0',
                        csImprovement: csPreAvg > 0 ? ((csPostAvg - csPreAvg) / csPreAvg * 100).toFixed(1) : '0',
                        mathPreAvg: mathPreAvg.toFixed(1),
                        mathPostAvg: mathPostAvg.toFixed(1),
                        csPreAvg: csPreAvg.toFixed(1),
                        csPostAvg: csPostAvg.toFixed(1),
                        validMathCount: validMathScores.length,
                        validCSCount: validCSScores.length,
                        duplicateCount: data.filter(d => d.Duplicates !== 'Unique').length
                    };
                }, [data]);

                // Calculate cohort statistics
                const cohortStats = useMemo(() => {
                    if (data.length === 0) return [];

                    return cohorts.map(cohort => {
                        const cohortData = data.filter(d => d.Cohort === cohort);
                        
                        const validMath = cohortData.filter(d => 
                            d['Math Pre-Test Score (10 max)'] !== null && 
                            d['Math Post-Test Score (10 max)'] !== null
                        );
                        
                        const validCS = cohortData.filter(d => 
                            d['Computer Pre-Test Score (10 max)'] !== null && 
                            d['Computer Post-Test Score (10 max)'] !== null
                        );

                        const mathPreAvg = validMath.length > 0 ? 
                            validMath.reduce((sum, d) => sum + d['Math Pre-Test Score (10 max)'], 0) / validMath.length : 0;
                        const mathPostAvg = validMath.length > 0 ? 
                            validMath.reduce((sum, d) => sum + d['Math Post-Test Score (10 max)'], 0) / validMath.length : 0;
                        const csPreAvg = validCS.length > 0 ? 
                            validCS.reduce((sum, d) => sum + d['Computer Pre-Test Score (10 max)'], 0) / validCS.length : 0;
                        const csPostAvg = validCS.length > 0 ? 
                            validCS.reduce((sum, d) => sum + d['Computer Post-Test Score (10 max)'], 0) / validCS.length : 0;

                        // Create shorter display names for charts
                        const shortName = cohort.includes('John Muir') ? 
                            (cohort.includes('Spring') ? 'JM Spring 25' : 'JM Fall 24') :
                            (cohort.includes('Spring') ? 'Bancroft Spring 25' : 'Bancroft Fall 24');

                        return {
                            cohort,
                            shortName,
                            students: cohortData.length,
                            mathPre: parseFloat(mathPreAvg.toFixed(1)),
                            mathPost: parseFloat(mathPostAvg.toFixed(1)),
                            csPre: parseFloat(csPreAvg.toFixed(1)),
                            csPost: parseFloat(csPostAvg.toFixed(1)),
                            mathImprovement: mathPreAvg > 0 ? ((mathPostAvg - mathPreAvg) / mathPreAvg * 100).toFixed(1) : '0',
                            csImprovement: csPreAvg > 0 ? ((csPostAvg - csPreAvg) / csPreAvg * 100).toFixed(1) : '0',
                            validMathCount: validMath.length,
                            validCSCount: validCS.length
                        };
                    });
                }, [data, cohorts]);

                // Filter data for individual view
                const filteredStudents = useMemo(() => {
                    let filtered = data;
                    
                    if (selectedCohort !== 'all') {
                        filtered = filtered.filter(d => d.Cohort === selectedCohort);
                    }
                    
                    if (searchTerm) {
                        filtered = filtered.filter(d => 
                            d.ID?.toLowerCase().includes(searchTerm.toLowerCase())
                        );
                    }
                    
                    return filtered;
                }, [data, selectedCohort, searchTerm]);

                const StatCard = ({ title, value, subtitle, icon: Icon, color = "blue" }) => 
                    React.createElement('div', {
                        className: `bg-white rounded-lg shadow-md p-6 border-l-4 border-${color}-500 stat-card`
                    }, 
                        React.createElement('div', { className: 'flex items-center justify-between' },
                            React.createElement('div', null,
                                React.createElement('p', { className: 'text-gray-600 text-sm font-medium' }, title),
                                React.createElement('p', { className: `text-2xl font-bold text-${color}-600` }, value),
                                subtitle && React.createElement('p', { className: 'text-gray-500 text-sm' }, subtitle)
                            ),
                            Icon && React.createElement(Icon, { className: `h-8 w-8 text-${color}-500` })
                        )
                    );

                if (loading) {
                    return React.createElement('div', {
                        className: 'min-h-screen bg-gray-100 flex items-center justify-center'
                    },
                        React.createElement('div', { className: 'text-center' },
                            React.createElement('div', { 
                                className: 'animate-spin rounded-full h-32 w-32 border-b-2 border-blue-500 mx-auto' 
                            }),
                            React.createElement('p', { className: 'mt-4 text-gray-600' }, 'Loading STEM program data...')
                        )
                    );
                }

                const renderOverview = () => 
                    React.createElement('div', { className: 'space-y-6' },
                        // Error message if data couldn't be loaded
                        error && React.createElement('div', {
                            className: 'bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-6'
                        },
                            React.createElement('p', { className: 'text-yellow-800' }, 
                                '⚠️ Using sample data - could not load actual CSV file. Upload your data file to see real results.'
                            )
                        ),
                        React.createElement('div', { className: 'grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6' },
                            React.createElement(StatCard, { 
                                title: 'Total Students', 
                                value: programStats.totalStudents,
                                subtitle: `${programStats.duplicateCount} multi-cohort participants`,
                                icon: Icons.Users,
                                color: 'blue'
                            }),
                            React.createElement(StatCard, { 
                                title: 'Math Improvement', 
                                value: `${programStats.mathImprovement}%`,
                                subtitle: `${programStats.mathPreAvg} → ${programStats.mathPostAvg} avg`,
                                icon: Icons.BookOpen,
                                color: 'green'
                            }),
                            React.createElement(StatCard, { 
                                title: 'CS Improvement', 
                                value: `${programStats.csImprovement}%`,
                                subtitle: `${programStats.csPreAvg} → ${programStats.csPostAvg} avg`,
                                icon: Icons.Monitor,
                                color: 'purple'
                            }),
                            React.createElement(StatCard, { 
                                title: 'Data Completeness', 
                                value: `${Math.round((programStats.validMathCount + programStats.validCSCount) / (programStats.totalStudents * 2) * 100)}%`,
                                subtitle: `${programStats.validMathCount + programStats.validCSCount}/${programStats.totalStudents * 2} scores`,
                                icon: Icons.TrendingUp,
                                color: 'orange'
                            })
                        ),
                        React.createElement('div', { className: 'grid grid-cols-1 lg:grid-cols-2 gap-6' },
                            React.createElement('div', { className: 'bg-white rounded-lg shadow-md p-6' },
                                React.createElement('h3', { className: 'text-lg font-semibold mb-4' }, 'Math Performance by Cohort'),
                                React.createElement(ResponsiveContainer, { width: '100%', height: 300 },
                                    React.createElement(BarChart, { 
                                        data: cohortStats, 
                                        margin: { top: 20, right: 30, left: 20, bottom: 60 } 
                                    },
                                        React.createElement(CartesianGrid, { strokeDasharray: '3 3' }),
                                        React.createElement(XAxis, { 
                                            dataKey: 'shortName',
                                            angle: -45,
                                            textAnchor: 'end',
                                            height: 80,
                                            fontSize: 12
                                        }),
                                        React.createElement(YAxis, { domain: [0, 10] }),
                                        React.createElement(Tooltip),
                                        React.createElement(Legend),
                                        React.createElement(Bar, { dataKey: 'mathPre', fill: '#8884d8', name: 'Pre-Test' }),
                                        React.createElement(Bar, { dataKey: 'mathPost', fill: '#82ca9d', name: 'Post-Test' })
                                    )
                                )
                            ),
                            React.createElement('div', { className: 'bg-white rounded-lg shadow-md p-6' },
                                React.createElement('h3', { className: 'text-lg font-semibold mb-4' }, 'Computer Science Performance by Cohort'),
                                React.createElement(ResponsiveContainer, { width: '100%', height: 300 },
                                    React.createElement(BarChart, { 
                                        data: cohortStats, 
                                        margin: { top: 20, right: 30, left: 20, bottom: 60 } 
                                    },
                                        React.createElement(CartesianGrid, { strokeDasharray: '3 3' }),
                                        React.createElement(XAxis, { 
                                            dataKey: 'shortName',
                                            angle: -45,
                                            textAnchor: 'end',
                                            height: 80,
                                            fontSize: 12
                                        }),
                                        React.createElement(YAxis, { domain: [0, 10] }),
                                        React.createElement(Tooltip),
                                        React.createElement(Legend),
                                        React.createElement(Bar, { dataKey: 'csPre', fill: '#8884d8', name: 'Pre-Test' }),
                                        React.createElement(Bar, { dataKey: 'csPost', fill: '#ffc658', name: 'Post-Test' })
                                    )
                                )
                            )
                        ),
                        React.createElement('div', { className: 'bg-white rounded-lg shadow-md p-6' },
                            React.createElement('h3', { className: 'text-lg font-semibold mb-4' }, 'Improvement Comparison Across Cohorts'),
                            React.createElement(ResponsiveContainer, { width: '100%', height: 300 },
                                React.createElement(BarChart, { 
                                    data: cohortStats, 
                                    margin: { top: 20, right: 30, left: 20, bottom: 60 } 
                                },
                                    React.createElement(CartesianGrid, { strokeDasharray: '3 3' }),
                                    React.createElement(XAxis, { 
                                        dataKey: 'shortName',
                                        angle: -45,
                                        textAnchor: 'end',
                                        height: 80,
                                        fontSize: 12
                                    }),
                                    React.createElement(YAxis),
                                    React.createElement(Tooltip),
                                    React.createElement(Legend),
                                    React.createElement(Bar, { dataKey: 'mathImprovement', fill: '#82ca9d', name: 'Math % Improvement' }),
                                    React.createElement(Bar, { dataKey: 'csImprovement', fill: '#ffc658', name: 'CS % Improvement' })
                                )
                            )
                        )
                    );

                const renderCohortAnalysis = () => 
                    React.createElement('div', { className: 'space-y-6' },
                        React.createElement('div', { className: 'grid grid-cols-1 md:grid-cols-2 gap-6' },
                            cohortStats.map(cohort => 
                                React.createElement('div', { 
                                    key: cohort.cohort, 
                                    className: 'bg-white rounded-lg shadow-md p-6' 
                                },
                                    React.createElement('h3', { className: 'text-lg font-semibold mb-4 text-center' }, cohort.cohort),
                                    React.createElement('div', { className: 'grid grid-cols-2 gap-4 text-sm' },
                                        React.createElement('div', { className: 'space-y-2' },
                                            React.createElement('div', { className: 'flex justify-between' },
                                                React.createElement('span', { className: 'text-gray-600' }, 'Students:'),
                                                React.createElement('span', { className: 'font-medium' }, cohort.students)
                                            ),
                                            React.createElement('div', { className: 'flex justify-between' },
                                                React.createElement('span', { className: 'text-gray-600' }, 'Math Data:'),
                                                React.createElement('span', { className: 'text-xs' }, `${cohort.validMathCount}/${cohort.students}`)
                                            ),
                                            React.createElement('div', { className: 'flex justify-between' },
                                                React.createElement('span', { className: 'text-gray-600' }, 'CS Data:'),
                                                React.createElement('span', { className: 'text-xs' }, `${cohort.validCSCount}/${cohort.students}`)
                                            )
                                        ),
                                        React.createElement('div', { className: 'space-y-2' },
                                            React.createElement('div', { className: 'flex justify-between' },
                                                React.createElement('span', { className: 'text-gray-600' }, 'Math Gain:'),
                                                React.createElement('span', { className: 'font-medium text-green-600' }, `${cohort.mathImprovement}%`)
                                            ),
                                            React.createElement('div', { className: 'flex justify-between' },
                                                React.createElement('span', { className: 'text-gray-600' }, 'CS Gain:'),
                                                React.createElement('span', { className: 'font-medium text-purple-600' }, `${cohort.csImprovement}%`)
                                            )
                                        )
                                    ),
                                    React.createElement('div', { className: 'mt-4 pt-4 border-t border-gray-200' },
                                        React.createElement('div', { className: 'text-xs text-gray-500 space-y-1' },
                                            React.createElement('div', { className: 'flex justify-between' },
                                                React.createElement('span', null, 'Math:'),
                                                React.createElement('span', null, `${cohort.mathPre} → ${cohort.mathPost}`)
                                            ),
                                            React.createElement('div', { className: 'flex justify-between' },
                                                React.createElement('span', null, 'CS:'),
                                                React.createElement('span', null, `${cohort.csPre} → ${cohort.csPost}`)
                                            )
                                        )
                                    )
                                )
                            )
                        )
                    );

                const renderIndividualTracking = () => 
                    React.createElement('div', { className: 'space-y-6' },
                        React.createElement('div', { className: 'bg-white rounded-lg shadow-md p-6' },
                            React.createElement('div', { className: 'flex flex-col sm:flex-row gap-4 mb-6' },
                                React.createElement('div', { className: 'relative flex-1' },
                                    React.createElement(Icons.Search, { className: 'h-5 w-5 absolute left-3 top-3 text-gray-400' }),
                                    React.createElement('input', {
                                        type: 'text',
                                        placeholder: 'Search by ID...',
                                        value: searchTerm,
                                        onChange: (e) => setSearchTerm(e.target.value),
                                        className: 'w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent'
                                    })
                                ),
                                React.createElement('select', {
                                    value: selectedCohort,
                                    onChange: (e) => setSelectedCohort(e.target.value),
                                    className: 'px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent'
                                },
                                    React.createElement('option', { value: 'all' }, 'All Cohorts'),
                                    cohorts.map(cohort => 
                                        React.createElement('option', { key: cohort, value: cohort }, cohort)
                                    )
                                )
                            ),
                            React.createElement('div', { className: 'text-sm text-gray-600 mb-4' },
                                `Showing ${filteredStudents.length} of ${data.length} students`
                            ),
                            React.createElement('div', { className: 'overflow-x-auto' },
                                React.createElement('table', { className: 'min-w-full divide-y divide-gray-200' },
                                    React.createElement('thead', { className: 'bg-gray-50' },
                                        React.createElement('tr', null,
                                            React.createElement('th', { className: 'px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider' }, 'Student ID'),
                                            React.createElement('th', { className: 'px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider' }, 'Cohort'),
                                            React.createElement('th', { className: 'px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider' }, 'Math Scores'),
                                            React.createElement('th', { className: 'px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider' }, 'CS Scores'),
                                            React.createElement('th', { className: 'px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider' }, 'Status')
                                        )
                                    ),
                                    React.createElement('tbody', { className: 'bg-white divide-y divide-gray-200' },
                                        filteredStudents.map((student, index) => 
                                            React.createElement('tr', { 
                                                key: student.ID, 
                                                className: index % 2 === 0 ? 'bg-white' : 'bg-gray-50' 
                                            },
                                                React.createElement('td', { className: 'px-6 py-4 whitespace-nowrap' },
                                                    React.createElement('div', { className: 'text-sm font-medium text-gray-900' }, student.ID)
                                                ),
                                                React.createElement('td', { className: 'px-6 py-4 whitespace-nowrap' },
                                                    React.createElement('div', { 
                                                        className: 'text-xs text-gray-600 max-w-24 truncate',
                                                        title: student.Cohort
                                                    }, student.Cohort)
                                                ),
                                                React.createElement('td', { className: 'px-6 py-4 whitespace-nowrap text-sm' },
                                                    React.createElement('div', { className: 'flex items-center space-x-2' },
                                                        React.createElement('span', { className: 'text-red-600 font-medium' }, 
                                                            student['Math Pre-Test Score (10 max)'] || 'N/A'
                                                        ),
                                                        React.createElement('span', { className: 'text-gray-400' }, '→'),
                                                        React.createElement('span', { className: 'text-green-600 font-medium' }, 
                                                            student['Math Post-Test Score (10 max)'] || 'N/A'
                                                        )
                                                    ),
                                                    student['Math Normalized Gain (%)'] && 
                                                        React.createElement('div', { className: 'text-xs text-gray-500' }, 
                                                            `Gain: ${student['Math Normalized Gain (%)']}%`
                                                        )
                                                ),
                                                React.createElement('td', { className: 'px-6 py-4 whitespace-nowrap text-sm' },
                                                    React.createElement('div', { className: 'flex items-center space-x-2' },
                                                        React.createElement('span', { className: 'text-red-600 font-medium' }, 
                                                            student['Computer Pre-Test Score (10 max)'] || 'N/A'
                                                        ),
                                                        React.createElement('span', { className: 'text-gray-400' }, '→'),
                                                        React.createElement('span', { className: 'text-green-600 font-medium' }, 
                                                            student['Computer Post-Test Score (10 max)'] || 'N/A'
                                                        )
                                                    ),
                                                    student['Computer  Normalized Gain (%)'] && 
                                                        React.createElement('div', { className: 'text-xs text-gray-500' }, 
                                                            `Gain: ${student['Computer  Normalized Gain (%)']}%`
                                                        )
                                                ),
                                                React.createElement('td', { className: 'px-6 py-4 whitespace-nowrap' },
                                                    React.createElement('span', { 
                                                        className: `inline-flex px-2 py-1 text-xs font-semibold rounded-full ${
                                                            student.Duplicates === 'Unique' 
                                                                ? 'bg-green-100 text-green-800' 
                                                                : 'bg-orange-100 text-orange-800'
                                                        }`
                                                    }, student.Duplicates || 'Unknown')
                                                )
                                            )
                                        )
                                    )
                                )
                            ),
                            filteredStudents.length === 0 && 
                                React.createElement('div', { className: 'text-center py-8 text-gray-500' },
                                    'No students found matching your search criteria.'
                                )
                        )
                    );

                return React.createElement('div', { className: 'min-h-screen bg-gray-100 p-6' },
                    React.createElement('div', { className: 'max-w-7xl mx-auto' },
                        React.createElement('div', { className: 'mb-8' },
                            React.createElement('h1', { className: 'text-3xl font-bold text-gray-900 mb-2' }, 'STEM Program Analysis Dashboard'),
                            React.createElement('p', { className: 'text-gray-600' }, 'Comprehensive analysis of pre/post performance in Math and Computer Science'),
                            data.length > 0 && React.createElement('p', { className: 'text-sm text-gray-500 mt-2' }, 
                                `Data loaded: ${data.length} student records across ${cohorts.length} cohorts`
                            )
                        ),
                        React.createElement('div', { className: 'mb-6' },
                            React.createElement('nav', { className: 'flex space-x-1 bg-white rounded-lg shadow-sm p-1' },
                                React.createElement('button', {
                                    onClick: () => setActiveView('overview'),
                                    className: `px-4 py-2 rounded-md font-medium text-sm transition-colors ${
                                        activeView === 'overview' 
                                            ? 'bg-blue-500 text-white shadow-sm' 
                                            : 'text-gray-700 hover:text-gray-900 hover:bg-gray-100'
                                    }`
                                }, 'Program Overview'),
                                React.createElement('button', {
                                    onClick: () => setActiveView('cohorts'),
                                    className: `px-4 py-2 rounded-md font-medium text-sm transition-colors ${
                                        activeView === 'cohorts' 
                                            ? 'bg-blue-500 text-white shadow-sm' 
                                            : 'text-gray-700 hover:text-gray-900 hover:bg-gray-100'
                                    }`
                                }, 'Cohort Analysis'),
                                React.createElement('button', {
                                    onClick: () => setActiveView('individual'),
                                    className: `px-4 py-2 rounded-md font-medium text-sm transition-colors ${
                                        activeView === 'individual' 
                                            ? 'bg-blue-500 text-white shadow-sm' 
                                            : 'text-gray-700 hover:text-gray-900 hover:bg-gray-100'
                                    }`
                                }, 'Individual Tracking')
                            )
                        ),
                        data.length === 0 ? 
                            React.createElement('div', { className: 'bg-white rounded-lg shadow-md p-8 text-center' },
                                React.createElement(Icons.BarChart3, { className: 'h-16 w-16 text-gray-400 mx-auto mb-4' }),
                                React.createElement('h3', { className: 'text-lg font-medium text-gray-900 mb-2' }, 'No Data Available'),
                                React.createElement('p', { className: 'text-gray-600' }, 'Unable to load STEM program data. Please ensure the data file is available.')
                            ) :
                            (activeView === 'overview' && renderOverview()) ||
                            (activeView === 'cohorts' && renderCohortAnalysis()) ||
                            (activeView === 'individual' && renderIndividualTracking())
                    )
                );
            };

            // Render the dashboard
            const root = ReactDOM.createRoot(document.getElementById('dashboard-root'));
            root.render(React.createElement(STEMDashboard));
        });
    </script>
</body>
</html>
